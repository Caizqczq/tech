# 后端前端接口完整对接需求文档

## 介绍

本项目需要完整对接前端React应用与后端Spring Boot应用的所有API接口。前端使用React + TypeScript + Vite技术栈，后端使用Spring Boot + Spring AI Alibaba + MyBatis Plus技术栈。目标是确保前端定义的所有API调用都能在后端得到完整实现，最大程度复用现有后端代码。

## 需求

### 需求1：用户认证模块完整对接

**用户故事：** 作为前端开发者，我希望所有用户认证相关的API都能正常工作，以便用户可以注册、登录、登出和获取用户信息。

#### 验收标准

1. WHEN 前端调用注册接口 THEN 后端应返回符合前端期望格式的用户信息
2. WHEN 前端调用登录接口 THEN 后端应返回包含token和user对象的响应
3. WHEN 前端调用登出接口 THEN 后端应正确处理token黑名单
4. WHEN 前端调用获取当前用户信息接口 THEN 后端应返回完整的用户信息
5. WHEN 前端调用测试接口 THEN 后端应返回符合前端期望的响应格式

### 需求2：AI对话模块完整对接

**用户故事：** 作为前端开发者，我希望所有AI对话相关的API都能正常工作，以便用户可以进行简单对话、流式对话和图片分析。

#### 验收标准

1. WHEN 前端调用简单对话接口 THEN 后端应返回包含content、conversationId、usage和responseTime的响应
2. WHEN 前端调用流式对话接口 THEN 后端应返回流式文本响应
3. WHEN 前端调用图片分析URL接口 THEN 后端应返回包含分析结果和图片URL的响应
4. WHEN 前端调用图片分析上传接口 THEN 后端应返回包含分析结果和文件信息的响应

### 需求3：教学AI对话模块完整对接

**用户故事：** 作为教师用户，我希望所有教学AI功能都能正常工作，以便获得教学建议、内容分析、写作辅助和智能对话支持。

#### 验收标准

1. WHEN 前端调用教学建议接口 THEN 后端应返回包含advice、suggestions、resources和usage的响应
2. WHEN 前端调用内容分析接口 THEN 后端应返回包含analysis、keyPoints、improvements和score的响应
3. WHEN 前端调用写作辅助接口 THEN 后端应返回包含assistance、suggestions和corrections的响应
4. WHEN 前端调用智能对话助手接口 THEN 后端应返回包含response、conversationId、mode和usage的响应
5. WHEN 前端调用流式智能对话助手接口 THEN 后端应返回Server-Sent Events格式的流式响应

### 需求4：对话管理模块完整对接

**用户故事：** 作为用户，我希望能够管理我的对话记录，包括查看、删除、更新标题和获取统计信息。

#### 验收标准

1. WHEN 前端调用获取对话列表接口 THEN 后端应返回包含conversations数组和pagination信息的响应
2. WHEN 前端调用获取对话详情接口 THEN 后端应返回包含完整消息记录的对话详情
3. WHEN 前端调用删除对话接口 THEN 后端应成功删除对话并返回确认信息
4. WHEN 前端调用清空所有对话接口 THEN 后端应清空用户所有对话记录
5. WHEN 前端调用更新对话标题接口 THEN 后端应更新对话标题并返回确认信息
6. WHEN 前端调用获取对话统计接口 THEN 后端应返回包含统计数据的响应

### 需求5：智能教学资源管理模块完整对接

**用户故事：** 作为教师用户，我希望能够上传、管理和检索教学资源，包括文档、音频和批量上传功能。

#### 验收标准

1. WHEN 前端调用文档上传接口 THEN 后端应处理文档上传并返回包含resourceId、extractedContent和metadata的响应
2. WHEN 前端调用音频上传接口 THEN 后端应处理音频上传和转录并返回包含transcriptionText的响应
3. WHEN 前端调用批量上传接口 THEN 后端应处理多文件上传并返回批量处理结果
4. WHEN 前端调用资源查询接口 THEN 后端应返回分页的资源列表
5. WHEN 前端调用语义搜索接口 THEN 后端应返回基于向量搜索的相关资源
6. WHEN 前端调用资源详情接口 THEN 后端应返回完整的资源详细信息
7. WHEN 前端调用删除资源接口 THEN 后端应删除资源并返回确认信息
8. WHEN 前端调用获取下载链接接口 THEN 后端应返回安全的下载URL
9. WHEN 前端调用资源统计接口 THEN 后端应返回资源统计数据

### 需求6：知识库RAG功能完整对接

**用户故事：** 作为教师用户，我希望能够构建和使用知识库进行智能问答，以便更好地利用教学资源。

#### 验收标准

1. WHEN 前端调用构建知识库接口 THEN 后端应创建知识库并返回构建状态
2. WHEN 前端调用知识库状态查询接口 THEN 后端应返回构建进度和状态信息
3. WHEN 前端调用知识库列表接口 THEN 后端应返回用户的知识库列表
4. WHEN 前端调用RAG查询接口 THEN 后端应返回基于知识库的智能回答和相关来源
5. WHEN 前端调用RAG流式查询接口 THEN 后端应返回流式的智能回答

### 需求7：AI资源自动制作模块完整对接

**用户故事：** 作为教师用户，我希望能够使用AI自动生成PPT、测验和解释等教学资源。

#### 验收标准

1. WHEN 前端调用生成PPT接口 THEN 后端应创建PPT生成任务并返回taskId
2. WHEN 前端调用生成测验接口 THEN 后端应创建测验生成任务并返回taskId
3. WHEN 前端调用生成解释接口 THEN 后端应创建解释生成任务并返回taskId
4. WHEN 前端调用任务状态查询接口 THEN 后端应返回任务进度和结果信息

### 需求8：响应格式标准化

**用户故事：** 作为前端开发者，我希望所有API响应都遵循一致的格式标准，以便统一处理。

#### 验收标准

1. WHEN 任何API调用成功 THEN 后端应返回符合前端期望的数据结构
2. WHEN 任何API调用失败 THEN 后端应返回标准的错误响应格式
3. WHEN API需要分页 THEN 后端应返回包含pagination信息的响应
4. WHEN API涉及文件操作 THEN 后端应正确处理multipart/form-data请求
5. WHEN API需要认证 THEN 后端应正确验证JWT token并处理未授权情况

### 需求9：数据库和存储集成

**用户故事：** 作为系统管理员，我希望所有数据都能正确存储和检索，包括用户数据、对话记录、资源文件和向量数据。

#### 验收标准

1. WHEN 用户注册或更新信息 THEN 数据应正确存储到用户表
2. WHEN 进行对话 THEN 对话记录应正确存储到对话相关表
3. WHEN 上传资源 THEN 文件应正确存储并建立数据库记录
4. WHEN 构建知识库 THEN 向量数据应正确存储到向量数据库
5. WHEN 查询数据 THEN 应支持分页、筛选和排序功能

### 需求10：性能和安全优化

**用户故事：** 作为系统用户，我希望系统响应快速且安全可靠。

#### 验收标准

1. WHEN 处理大文件上传 THEN 系统应有适当的文件大小限制和错误处理
2. WHEN 进行向量搜索 THEN 系统应在合理时间内返回结果
3. WHEN 用户认证 THEN 系统应正确验证token并处理过期情况
4. WHEN 处理并发请求 THEN 系统应保持稳定性能
5. WHEN 发生错误 THEN 系统应返回有意义的错误信息而不暴露敏感信息